# Status code

클라이언트가 보낸 요청의 처리상태를 응답에서 알려주는 기능

- 1xx(Informational)
  - 요청이 수신되어 처리중
  - 거의 사용되지 않음
- 2xx(Sucessful)
  - 요청 정상 처리
- 3xx(Redirection)
  - 요청을 완료하려면 추가 행동이 필요하다는 것
- 4xx(Client Error)
  - 클라이언트 오류, 잘못된 문법
  - 서버가 요청을 수행할 수 없음
- 5xx(Server Error)
  - 서버 오류
  - 서버가 정상 요청을 처리하지 못함

## 2xx - 성공

- 200
  - 요청 성공(OK)
  - GET 요청을 통에 대한 응답메시지에서 주로 볼 수 있다
- 201
  - 요청 해서 새로운 리소스가 생성됨(Created)
  - collection을 통한 post 예제에서 살펴봤음
- 202
  - 요청이 접수되었으나 처리가 되지 않았다(Accepted)
  - 배치처리 같은 곳에서 사용된다
- 204
  - 서버가 요청을 수행했지만, 응답 body에 보낼 데이터가 없다(No Content)
  - 예를 들어 save 결과로 아무 내용이 없어도 된다

## 3xx - 리다이렉션

### 리다이렉션 이해 
- 요청을 완료하기 위해 유저의 추가 조치가 필요한 경우에 사용된다
- 웹 브라우저는 3xx 응답 결과에 Location 헤더가 있다면 Location 위치로 자동 이동된다
- 영구 리다이렉션
  - 특정 리소스의 URI가 영구적으로 이동된 경우
  - 원래의 URL을 사용하면 안되고 검색 엔진에서도 변경을 인지한다
  - /members -> /users
  - 301
    - Moved Permanently
    - 리다이렉트시, 요청 메서드가 GET으로 변하고 본문이 제거될 수 있다 (POST -> GET)
  - 308
    - Permanent Redirect
    - 리다이렉트시, 요청 메서드와 본문 유지 (POST -> POST)
- 일시 리다이렉션
  - 리소스의 URI가 일시적으로 변경되는 것, 따라서 검색엔진 등에서 URL을 변경하면 안됨
  - 302 (FOUND)
    - 리다이렉트 요청 메서드가 대부분 GET으로 변하고, 본문이 제거될 수 있음(MAY)
  - 307 (Temporary Redirect)
    - 리다이렉트 요청 메서드가 본문 유지(요청 메서드가 무조건 변경되면 안된다!!!)
  - 303 (See Other)
    - 리다이렉트 요청 메서드가 무조건 GET으로 변경된다
  - PRG: POST / REDIRECT / GET
    - POST로 주문 후 웹 브라우저를 새로고침하면 어떻게 될까?
      - 새로고침은 다시 요청이기 때문에, 중복 주문이 될 수 있다
    - 이 문제를 해결하기 위해 POST로 주문 후, 결과 화면을 GET 메서드로 리다이렉트!
    - 새로고침을 해도 결과 화면을 GET으로 조회만 되게끔한다
  - 현실적으로 307, 303을 권장하지만 이미 많은 어플리케이션들이 302를 default로 사용한다
    - 자동 리다이렉션시 GET으로 변해도 되면 그냥 302를 사용해도 큰 문제는 없다
- 기타 리다이렉션
  - 300 (Multiple Choices) : 안씀
  - 304 (Not Modified)
    - 캐시를 목적으로 사용한다
    - 클라이언트에게 리소스가 수정되지 않았음을 알려주며, 로컬에 저장된 캐시를 재사용한다
      - 캐시로 리다이렉트한다로 이해하면 된다
    - 304는 메시지 바디를 포함하면 안된다
      - 로컬 캐시를 사용하기로 했으니까!
    - 조건부 GET, HEAD 요청시에 사용한다
  
## 4xx - Client Error

- 클라이언트의 요청에 잘못된 문법등으로 인해 서버가 요청을 수행할 수 없을 때
- **오류의 원인은 클라이언트**
- 중요한건 클라이언트 쪽이 문제가 발생하므로 몇 번을 다시 시도해도 계속 실패한다.
- 즉, 복구 불가능
- 400 (Bad Request)
  - 클라이언트가 잘못된 요청을 해서 서버가 처리할 수 없을 때
  - 클라이언트가 요청내용을 다시 검토해야한다
- 401 (Unauthorized)
  - 인증이 되지 않았다(authentication)
  - WWW-Authenticate 헤더와 함께 인증 방법을 설명한다
  - 참고
    - **인증**(Authentication)
      - 본인이 누구인지 확인 (로그인)
    - **인가**(Authorization)
      - 권한이 있다 없다
      - 특정 리소스에 접근할 수 있는 권한이 있다
      - 인증 이후에 인가가 있음
    - 인증과 인가를 잘 구별해야한다
  - 오류 메시지는 Unauthorized이지만 사실상 authentication이 되지 않은 거다
- 403 (Forbidden)
  - 서버가 요청을 이해했지만 승인을 거부하는 경우
  - 인증 자격은 있지만 권한이 불충분한 경우
- 404 (Not Found)
  - 요청한 리소스가 서버가 없을 때 발생한다
    - 클라이언트가 애초에 잘못된 리소스에 접근한 거기 때문에 클라이언트 오류!
  - 클라이언트가 권한이 부족하지만 리소스에 접근하는 경우에 리소스를 숨기자 할 때도 사용한다

## 5xx - Server Error

- 서버 문제로 오류 발생
- 서버 문제기 때문에 서버 문제가 해결되면 클라이언트가 다시 시도하면 동작가능성이 있다
- 500 (Internal Server Error)
  - 서버 내부 문제로 오류 발생
  - 애매하면 다 500 error로 처리
- 503 (Service Unavailable)
  - 서버가 일시적인 과부하나 예정된 작업으로 요청을 처리할 수 없는 경우
  - Retry-After 헤더 필드로 얼마뒤에 복구되는지도 보낼 수 있다
  - 하지만 보통 그냥 500으로 처리

> 4xx에러와 5xx에러를 잘 구별해한다.  
> 무슨 말이냐면 5xx에러는 서버 에러이고 복구되면 다시 동작하기 때문에
> 클라이언트 에러인데 서버에러로 처리하면 클라이언트 쪽에서는 나중에도 계속 잘못된 시도를 할 수 있다